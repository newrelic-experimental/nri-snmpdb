--
-- This SQL file will create a new and empty NRI-SQLDB
--

--
-- Relation storing MIB names
--
CREATE TABLE IF NOT EXISTS MIB (
  ID      INTEGER PRIMARY KEY AUTOINCREMENT,
  NAME    TEXT  NOT NULL
);
CREATE UNIQUE INDEX MIB_1 ON MIB(NAME);

--
-- Realtionship between MIB's
--
CREATE TABLE IF NOT EXISTS MREL (
  ID      INTEGER NOT NULL,
  CHILD   INTEGER NOT NULL
);
CREATE INDEX MREL_1 ON MREL(ID);
CREATE INDEX MREL_2 ON MREL(CHILD);

--
-- Relation storing SNMP OBJECTS
--
CREATE TABLE IF NOT EXISTS OBJECT (
  ID      INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL,
  MIB     INTEGER NOT NULL,
  EKEY    INTEGER,
  KEY     TEXT  NOT NULL,
  NAME    TEXT  NOT NULL,
  DESCR   TEXT
);
CREATE INDEX NAME_1 ON OBJECT(KEY);
CREATE INDEX NAME_2 ON OBJECT(NAME);

--
-- Relation storing relationships between objects
--
CREATE TABLE IF NOT EXISTS RELATION (
  ID      INTEGER NOT NULL,
  CHILD   INTEGER NOT NULL,
  MIB     INTEGER,
  IX      INTEGER
);
CREATE INDEX REL_1 ON RELATION(ID);
CREATE INDEX REL_2 ON RELATION(CHILD);

--
-- Relation storing ENUM info
--
CREATE TABLE IF NOT EXISTS ENUM (
  ID      INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL,
  NAME    TEXT NOT NULL,
  VALUE   BLOB
);
CREATE UNIQUE INDEX EN_1 ON ENUM(NAME);

--
-- Relation storing VENDOR info
--
CREATE TABLE IF NOT EXISTS VENDOR (
  ID      INTEGER PRIMARY KEY AUTOINCREMENT,
  NAME    TEXT  NOT NULL
);
CREATE UNIQUE INDEX VENDOR_1 ON VENDOR(NAME);

--
-- Relation storing discovery data
--
CREATE TABLE IF NOT EXISTS DISCOVERY (
  ID      INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL,
  VID     INTEGER,
  OID     INTEGER,
  NAME    INTEGER,
  MIB     INTEGER
);
CREATE INDEX DIS_1 ON DISCOVERY(VID);
CREATE INDEX DIS_2 ON DISCOVERY(OID);
CREATE INDEX DIS_3 ON DISCOVERY(MIB);
CREATE INDEX DIS_4 ON DISCOVERY(NAME);

.schema
.exit 0
